SELECT 'CREATE DATABASE book_recommender'
WHERE NOT EXISTS (SELECT FROM pg_database WHERE datname = 'book_recommender')\gexec


\c book_recommender

-- Таблица книг
CREATE TABLE IF NOT EXISTS books (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    author VARCHAR(255) NOT NULL,
    genre VARCHAR(100) NOT NULL,
    age_limit VARCHAR(10),
    author_origin VARCHAR(50) NOT NULL,
    keywords TEXT[],
    description TEXT,
    url VARCHAR(255) NOT NULL,
    rating FLOAT
);

-- Таблица пользователей
CREATE TABLE IF NOT EXISTS user_preferences (
    user_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    preferred_genres VARCHAR(100)[],
    preferred_authors VARCHAR(100)[],
    age_limit VARCHAR(10),
    author_origin_preference VARCHAR(50),
    search_history JSONB
);


INSERT INTO books (title, author, genre, age_limit, author_origin, keywords, description, url, rating) VALUES
-- Русская классика
('Преступление и наказание', 'Федор Достоевский', 'Классика', '16+', 'Русский', 
 '{"психология", "преступление", "нравственность"}', 
 'Глубокий психологический роман о преступлении и его последствиях', 
 'https://www.litres.ru/fedor-dostoevskiy/prestuplenie-i-nakazanie-18912523/', 4.7),
('Война и мир', 'Лев Толстой', 'Классика', '16+', 'Русский', 
 '{"исторический роман", "наполеоновские войны", "русская аристократия"}', 
 'Эпическое повествование о жизни русского общества во время войны с Наполеоном', 
 'https://www.litres.ru/lev-tolstoy/voyna-i-mir-18912521/', 4.8),
('Мастер и Маргарита', 'Михаил Булгаков', 'Классика', '16+', 'Русский', 
 '{"мистика", "советская литература", "философия"}', 
 'Великий роман о любви, дьяволе и человеческой природе', 
 'https://www.litres.ru/mihail-bulgakov/master-i-margarita-18920092/', 4.9),

-- Зарубежная классика
('1984', 'Джордж Оруэлл', 'Антиутопия', '16+', 'Зарубежный', 
 '{"тоталитаризм", "дистопия", "политика"}', 
 'Классическая антиутопия о тоталитарном обществе', 
 'https://www.litres.ru/dzhordzh-oruell/1984-42489937/', 4.7),
('Улисс', 'Джеймс Джойс', 'Классика', '18+', 'Зарубежный', 
 '{"модернизм", "поток сознания", "Ирландия"}', 
 'Один из самых значительных романов XX века', 
 'https://www.litres.ru/dzheyms-dzhoys/uliss-18920093/', 4.5),
('Гордость и предубеждение', 'Джейн Остин', 'Роман', '12+', 'Зарубежный', 
 '{"любовь", "викторианская эпоха", "семья"}', 
 'Классический роман о любви и социальных предрассудках', 
 'https://www.litres.ru/dzheyn-ostin/gordost-i-predubezhdenie-18920094/', 4.8),

-- Фантастика
('Дюна', 'Фрэнк Герберт', 'Фантастика', '16+', 'Зарубежный', 
 '{"космос", "политика", "экология"}', 
 'Эпическая сага о пустынной планете и её обитателях', 
 'https://www.litres.ru/frenk-gerbert/dyuna-18920095/', 4.9),
('Пикник на обочине', 'Аркадий и Борис Стругацкие', 'Фантастика', '16+', 'Русский', 
 '{"сталкер", "зона", "аномальные явления"}', 
 'Культовый роман о Зоне и сталкерах', 
 'https://www.litres.ru/arkadiy-strugackiy/piknik-na-obochine-18920096/', 4.8),
('Марсианин', 'Энди Вейер', 'Фантастика', '16+', 'Зарубежный', 
 '{"Марс", "выживание", "наука"}', 
 'История астронавта, оставшегося в одиночестве на Марсе', 
 'https://www.litres.ru/endi-veyer/marsianin-18920097/', 4.7),

-- Фэнтези
('Властелин колец', 'Дж. Р. Р. Толкин', 'Фэнтези', '12+', 'Зарубежный', 
 '{"кольцо", "Средиземье", "приключения"}', 
 'Эпическая трилогия о борьбе за Кольцо Всевластья', 
 'https://www.litres.ru/dzhon-tolkin/vlastelin-kolec-18920098/', 4.9),
('Гарри Поттер и философский камень', 'Джоан Роулинг', 'Фэнтези', '12+', 'Зарубежный', 
 '{"магия", "школа", "дружба"}', 
 'Первая книга серии о юном волшебнике Гарри Поттере', 
 'https://www.litres.ru/dzhoan-rouling/garri-potter-i-filosofskiy-kamen-164983/', 4.9),
('Ведьмак. Последнее желание', 'Анджей Сапковский', 'Фэнтези', '16+', 'Зарубежный', 
 '{"ведьмак", "монстры", "магия"}', 
 'Первая книга цикла о ведьмаке Геральте из Ривии', 
 'https://www.litres.ru/andzhey-sapkovskiy/vedmak-poslednee-zhelanie-18920099/', 4.8),

-- Детективы
('Шерлок Холмс. Собака Баскервилей', 'Артур Конан Дойл', 'Детектив', '12+', 'Зарубежный', 
 '{"расследование", "загадка", "Лондон"}', 
 'Один из самых известных романов о Шерлоке Холмсе', 
 'https://www.litres.ru/artur-konan-doyl/sobaka-baskerviley-18920100/', 4.7),
('Убийство в Восточном экспрессе', 'Агата Кристи', 'Детектив', '16+', 'Зарубежный', 
 '{"Эркюль Пуаро", "загадочное убийство", "поезд"}', 
 'Классический детектив о расследовании убийства в поезде', 
 'https://www.litres.ru/agata-kristi/ubiystvo-v-vostochnom-ekspresse-18920101/', 4.8),
('Десять негритят', 'Агата Кристи', 'Детектив', '16+', 'Зарубежный', 
 '{"остров", "убийства", "загадка"}', 
 'Один из самых известных романов Агаты Кристи', 
 'https://www.litres.ru/agata-kristi/desyat-negritat-18920102/', 4.9),

-- Современная проза
('Текст', 'Дмитрий Глуховский', 'Роман', '18+', 'Русский', 
 '{"технологии", "месть", "Москва"}', 
 'Современный роман о цифровом мире и человеческих отношениях', 
 'https://www.litres.ru/dmitriy-gluhovskiy/text-18920103/', 4.5),
('Зулейха открывает глаза', 'Гузель Яхина', 'Роман', '16+', 'Русский', 
 '{"история", "репрессии", "выживание"}', 
 'Роман о раскулачивании 1930-х годов', 
 'https://www.litres.ru/guzel-yahina/zuleyha-otkryvaet-glaza-18920104/', 4.6),
('Лавр', 'Евгений Водолазкин', 'Роман', '16+', 'Русский', 
 '{"средневековье", "медицина", "святость"}', 
 'Роман о средневековом целителе', 
 'https://www.litres.ru/evgeniy-vodolazkin/lavr-18920105/', 4.7),

-- Научно-популярные
('Краткая история времени', 'Стивен Хокинг', 'Научпоп', '16+', 'Зарубежный', 
 '{"космос", "физика", "время"}', 
 'Знаменитая книга о природе Вселенной', 
 'https://www.litres.ru/stiven-hoking/kratkaya-istoriya-vremeni-18920106/', 4.8),
('Sapiens. Краткая история человечества', 'Юваль Ной Харари', 'Научпоп', '16+', 'Зарубежный', 
 '{"антропология", "эволюция", "история"}', 
 'Увлекательный рассказ об истории человеческого вида', 
 'https://www.litres.ru/yuval-noy-harari/sapiens-kratkaya-istoriya-chelovechestva-18920107/', 4.7),
('Иммунитет', 'Евгения Паршутина', 'Научпоп', '16+', 'Русский', 
 '{"медицина", "здоровье", "иммунная система"}', 
 'Книга о работе иммунной системы человека', 
 'https://www.litres.ru/evgeniya-parshutina/immunitet-18920108/', 4.5),

-- Детские книги
('Малыш и Карлсон', 'Астрид Линдгрен', 'Детская', '6+', 'Зарубежный', 
 '{"приключения", "дружба", "фантазия"}', 
 'История о мальчике и его необычном друге', 
 'https://www.litres.ru/astrid-lindgren/malysh-i-karlson-18920109/', 4.9),
('Винни-Пух и все-все-все', 'Алан Милн', 'Детская', '6+', 'Зарубежный', 
 '{"медвежонок", "приключения", "дружба"}', 
 'Классическая детская книга о приключениях Винни-Пуха', 
 'https://www.litres.ru/alan-miln/vinni-puh-i-vse-vse-vse-18920110/', 4.8),
('Денискины рассказы', 'Виктор Драгунский', 'Детская', '6+', 'Русский', 
 '{"детство", "школа", "приключения"}', 
 'Веселые рассказы о мальчике Дениске', 
 'https://www.litres.ru/viktor-dragunskiy/deniskiny-rasskazy-18920111/', 4.7),

-- Бизнес-литература
('Богатый папа, бедный папа', 'Роберт Кийосаки', 'Бизнес', '16+', 'Зарубежный', 
 '{"финансы", "инвестиции", "образование"}', 
 'Книга о финансовой грамотности и инвестициях', 
 'https://www.litres.ru/robert-kiyosaki/bogatyy-papa-bednyy-papa-18920112/', 4.6),
('7 навыков высокоэффективных людей', 'Стивен Кови', 'Бизнес', '16+', 'Зарубежный', 
 '{"саморазвитие", "лидерство", "успех"}', 
 'Классика литературы по саморазвитию', 
 'https://www.litres.ru/stiven-kovi/7-navykov-vysokoeffektivnyh-lyudey-18920113/', 4.7),
('Думай и богатей', 'Наполеон Хилл', 'Бизнес', '16+', 'Зарубежный', 
 '{"успех", "мотивация", "богатство"}', 
 'Классическая книга о достижении успеха', 
 'https://www.litres.ru/napoleon-hill/dumay-i-bogatey-18920114/', 4.5),

-- Психология
('Как завоевывать друзей и оказывать влияние на людей', 'Дейл Карнеги', 'Психология', '16+', 'Зарубежный', 
 '{"общение", "лидерство", "успех"}', 
 'Классическая книга о навыках общения', 
 'https://www.litres.ru/deyl-karnegi/kak-zavoevyvat-druzey-i-okazyvat-vliyanie-na-lyudey-18920115/', 4.7),
('Тонкое искусство пофигизма', 'Марк Мэнсон', 'Психология', '18+', 'Зарубежный', 
 '{"саморазвитие", "психология", "жизнь"}', 
 'Нестандартный подход к саморазвитию', 
 'https://www.litres.ru/mark-menson/tonkoe-iskusstvo-pofigizma-18920116/', 4.6),
('Сила настоящего', 'Экхарт Толле', 'Психология', '16+', 'Зарубежный', 
 '{"осознанность", "медитация", "духовность"}', 
 'Книга о жизни в настоящем моменте', 
 'https://www.litres.ru/ekhart-tolle/sila-nastoyaschego-18920117/', 4.5),

-- Ужасы
('Оно', 'Стивен Кинг', 'Ужасы', '18+', 'Зарубежный', 
 '{"клоун", "страх", "детство"}', 
 'Культовый роман ужасов о древнем зле', 
 'https://www.litres.ru/stiven-king/ono-18920118/', 4.8),
('Дракула', 'Брэм Стокер', 'Ужасы', '16+', 'Зарубежный', 
 '{"вампиры", "готика", "ужасы"}', 
 'Классический роман о графе Дракуле', 
 'https://www.litres.ru/brem-stoker/drakula-18920119/', 4.7),
('Зов Ктулху', 'Говард Лавкрафт', 'Ужасы', '16+', 'Зарубежный', 
 '{"мифы Ктулху", "космический ужас", "таинственное"}', 
 'Классика жанра ужасов от Лавкрафта', 
 'https://www.litres.ru/govard-lavkraft/zov-ktulhu-18920120/', 4.6),

-- Поэзия
('Евгений Онегин', 'Александр Пушкин', 'Поэзия', '12+', 'Русский', 
 '{"роман в стихах", "любовь", "русская литература"}', 
 'Великий роман в стихах о любви и жизни', 
 'https://www.litres.ru/aleksandr-pushkin/evgeniy-onegin-18920121/', 4.9),
('Лирика', 'Анна Ахматова', 'Поэзия', '12+', 'Русский', 
 '{"поэзия", "любовь", "страдание"}', 
 'Сборник стихотворений великой русской поэтессы', 
 'https://www.litres.ru/anna-ahmatova/lirika-18920122/', 4.8),
('Цветы зла', 'Шарль Бодлер', 'Поэзия', '16+', 'Зарубежный', 
 '{"декадентство", "красота", "страдание"}', 
 'Знаменитый сборник стихов французского поэта', 
 'https://www.litres.ru/sharl-bodler/cvety-zla-18920123/', 4.7),

-- Приключения
('Остров сокровищ', 'Роберт Льюис Стивенсон', 'Приключения', '12+', 'Зарубежный', 
 '{"пираты", "сокровища", "море"}', 
 'Классический приключенческий роман о поисках пиратского клада', 
 'https://www.litres.ru/robert-luis-stivenson/ostrov-sokrovisch-18920124/', 4.8),
('Дети капитана Гранта', 'Жюль Верн', 'Приключения', '12+', 'Зарубежный', 
 '{"путешествия", "география", "спасение"}', 
 'Приключенческий роман о кругосветном путешествии', 
 'https://www.litres.ru/zhul-vern/deti-kapitana-granta-18920125/', 4.7),
('Три мушкетера', 'Александр Дюма', 'Приключения', '12+', 'Зарубежный', 
 '{"история", "дружба", "приключения"}', 
 'Классический роман о приключениях д''Артаньяна и его друзей', 
 'https://www.litres.ru/aleksandr-dyuma/tri-mushketera-18920126/', 4.9),

-- Исторические романы
('Тихий Дон', 'Михаил Шолохов', 'Исторический роман', '16+', 'Русский', 
 '{"казачество", "революция", "гражданская война"}', 
 'Эпопея о жизни донского казачества в переломную эпоху', 
 'https://www.litres.ru/mihail-sholohov/tihiy-don-18920127/', 4.8),
('Война и мир', 'Лев Толстой', 'Исторический роман', '16+', 'Русский', 
 '{"наполеоновские войны", "русское общество", "история"}', 
 'Великий роман о жизни русского общества во время войны с Наполеоном', 
 'https://www.litres.ru/lev-tolstoy/voyna-i-mir-18912521/', 4.9),
('Пётр Первый', 'Алексей Толстой', 'Исторический роман', '16+', 'Русский', 
 '{"история России", "Пётр I", "реформы"}', 
 'Роман о жизни и деятельности Петра Великого', 
 'https://www.litres.ru/aleksey-tolstoy/petr-pervyy-18920128/', 4.7),

-- Современная зарубежная проза
('Три товарища', 'Эрих Мария Ремарк', 'Роман', '16+', 'Зарубежный', 
 '{"дружба", "любовь", "потеря"}', 
 'Трогательная история о дружбе и любви в послевоенной Германии', 
 'https://www.litres.ru/erih-mariya-remark/tri-tovarischa-18920045/', 4.8),
('Над пропастью во ржи', 'Джером Сэлинджер', 'Роман', '16+', 'Зарубежный', 
 '{"подросток", "бунт", "одиночество"}', 
 'Культовый роман о подростковом бунте и поиске себя', 
 'https://www.litres.ru/dzherom-selindzher/nad-propastyu-vo-rzhi-18920129/', 4.7),
('Уличный кот по имени Боб', 'Джеймс Боуэн', 'Роман', '12+', 'Зарубежный', 
 '{"кот", "дружба", "спасение"}', 
 'Трогательная история о том, как кот спас жизнь человеку', 
 'https://www.litres.ru/dzheyms-bouen/ulichnyy-kot-po-imeni-bob-18920130/', 4.6),

-- Научная фантастика
('Автостопом по галактике', 'Дуглас Адамс', 'Фантастика', '12+', 'Зарубежный', 
 '{"космос", "юмор", "приключения"}', 
 'Юмористическая фантастика о путешествиях по галактике', 
 'https://www.litres.ru/douglas-adams/avtostopom-po-galaktike-18920131/', 4.8),
('Солярис', 'Станислав Лем', 'Фантастика', '16+', 'Зарубежный', 
 '{"космос", "разумный океан", "контакт"}', 
 'Философская фантастика о встрече с непостижимым разумом', 
 'https://www.litres.ru/stanislav-lem/solyaris-18920132/', 4.7),
('Я, робот', 'Айзек Азимов', 'Фантастика', '12+', 'Зарубежный', 
 '{"роботы", "искусственный интеллект", "законы робототехники"}', 
 'Классический сборник рассказов о роботах и их взаимоотношениях с людьми', 
 'https://www.litres.ru/ayzek-azimov/ya-robot-18920133/', 4.8),

-- Современная русская проза
('Летоисчисление от Иоанна', 'Павел Крусанов', 'Роман', '16+', 'Русский', 
 '{"альтернативная история", "Россия", "мистика"}', 
 'Альтернативная история России с элементами мистики', 
 'https://www.litres.ru/pavel-krusanov/letoschislenie-ot-ioanna-18920134/', 4.5),
('ЖД', 'Дмитрий Быков', 'Роман', '16+', 'Русский', 
 '{"аллегория", "Россия", "железная дорога"}', 
 'Аллегорический роман о современной России', 
 'https://www.litres.ru/dmitriy-bykov/zhd-18920135/', 4.6),
('Брисбен', 'Евгений Водолазкин', 'Роман', '16+', 'Русский', 
 '{"музыка", "судьба", "время"}', 
 'Роман о музыканте, разрывающемся между прошлым и настоящим', 
 'https://www.litres.ru/evgeniy-vodolazkin/brisben-18920136/', 4.7),

-- Детективы (русские)
('Золотой телёнок', 'Илья Ильф, Евгений Петров', 'Роман', '12+', 'Русский', 
 '{"авантюра", "советская эпоха", "юмор"}', 
 'Классический роман о похождениях Остапа Бендера', 
 'https://www.litres.ru/ilya-ilf-evgeniy-petrov/zolotoy-telenok-18920137/', 4.8),
('Азазель', 'Борис Акунин', 'Детектив', '16+', 'Русский', 
 '{"исторический детектив", "Эраст Фандорин", "XIX век"}', 
 'Первый роман из серии о сыщике Эрасте Фандорине', 
 'https://www.litres.ru/boris-akunin/azazel-18920138/', 4.7),
('Пикник на обочине', 'Аркадий и Борис Стругацкие', 'Фантастика', '16+', 'Русский', 
 '{"сталкер", "зона", "аномальные явления"}', 
 'Культовый роман о Зоне и сталкерах', 
 'https://www.litres.ru/arkadiy-strugackiy/piknik-na-obochine-18920096/', 4.8),

-- Фэнтези (русские)
('Ночной дозор', 'Сергей Лукьяненко', 'Фэнтези', '16+', 'Русский', 
 '{"магия", "дозоры", "борьба добра и зла"}', 
 'Первый роман культового цикла о Дозорах', 
 'https://www.litres.ru/sergey-lukyanenko/nochnoy-dozor-18920139/', 4.7),
('Тайный город', 'Вадим Панов', 'Фэнтези', '16+', 'Русский', 
 '{"город", "магия", "тайны"}', 
 'Фэнтезийный цикл о скрытом от обычных людей мире', 
 'https://www.litres.ru/vadim-panov/taynyy-gorod-18920140/', 4.6),
('Волкодав', 'Мария Семёнова', 'Фэнтези', '16+', 'Русский', 
 '{"варвары", "месть", "приключения"}', 
 'Эпическое фэнтези о последнем воине из рода Серого Пса', 
 'https://www.litres.ru/mariya-semenova/volkodav-18920141/', 4.8),

-- Современная зарубежная литература
('Книжный вор', 'Маркус Зусак', 'Роман', '16+', 'Зарубежный', 
 '{"война", "книги", "девочка"}', 
 'Трогательная история девочки, спасающейся от ужасов войны с помощью книг', 
 'https://www.litres.ru/markus-zusak/knizhnyy-vor-18920142/', 4.8),
('Тень ветра', 'Карлос Руис Сафон', 'Роман', '16+', 'Зарубежный', 
 '{"Барселона", "тайны", "книги"}', 
 'Захватывающая история о таинственной книге и её авторе', 
 'https://www.litres.ru/karlos-ruis-safon/ten-vetra-18920143/', 4.7),
('Жутко громко и запредельно близко', 'Джонатан Сафран Фоер', 'Роман', '16+', 'Зарубежный', 
 '{"11 сентября", "потеря", "поиск"}', 
 'Трогательная история мальчика, потерявшего отца при теракте 11 сентября', 
 'https://www.litres.ru/dzhonatan-safran-foer/zhutko-gromko-i-zapredelno-blizko-18920144/', 4.6),

-- Юмористическая литература
('Двенадцать стульев', 'Илья Ильф, Евгений Петров', 'Роман', '12+', 'Русский', 
 '{"авантюра", "советская эпоха", "юмор"}', 
 'Классический сатирический роман о поисках бриллиантов', 
 'https://www.litres.ru/ilya-ilf-evgeniy-petrov/dvenadcat-stulev-18920145/', 4.8),
('Трое в лодке, не считая собаки', 'Джером К. Джером', 'Юмор', '12+', 'Зарубежный', 
 '{"путешествие", "юмор", "приключения"}', 
 'Классическая юмористическая повесть о путешествии по реке', 
 'https://www.litres.ru/dzherom-k-dzherom/troe-v-lodke-ne-schitaya-sobaki-18920146/', 4.7),
('Записки о Шерлоке Холмсе', 'Артур Конан Дойл', 'Детектив', '12+', 'Зарубежный', 
 '{"расследование", "загадка", "Лондон"}', 
 'Сборник рассказов о знаменитом сыщике', 
 'https://www.litres.ru/artur-konan-doyl/zapiski-o-sherloke-holmse-18920147/', 4.8);